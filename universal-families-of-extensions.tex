\section{Universal Families of Extensions}

Let $X$ and $S$ be Noetherian schemes over a field $k$. Let $f \from X \to S$ be a flat, projective morphism, and let $\mc{F}$ and $\mc{G}$ be coherent $\mc{O}_X$-modules, flat over $\mc{O}_X$.

Recall that an element $\xi \in \Ext^1_{X}(\mc{F},\mc{G})$ corresponds to an equivalence class of short exact sequences, or \emph{extensions}, of the form
\[
	\ses{\mc{G}}{\mc{E}}{\mc{F}},
\]
where two such sequences are equivalent if there exists an isomorphism between them that induces the identity on $\mc{F}$ and $\mc{G}$. The set of these equivalence classes can be given the structure of an $H^0(S,\mc{O}_S)$-module, see for example \cite[{}3.4]{weibel-homological-algebra}. This correspondence is functorial in both arguments, and preserves the $H^0(S, \mc{O}_S)$-module structure.

Explicitely, the sum of two elements of $\Ext^1$ corresponds to the Baer sum of the associated extensions, while the multiplication of an extension
as above by a scalar $a\in H^0(S,\mc{O}_S)$ is given by the pullback sequence along the map $\mc{F}\xto{a}\mc{F}$.

The next proposition shows there exists a $k$-scheme $V$ that parametrizes the points of $\Ext^{1}_X(\mc{F},\mc{G})$.

\begin{proposition} \label{cor:universal-extension}
Let $V \coloneqq \VV(\Ext^1_X(\mc{F},\mc{G})\dual)$. There exists an extension
	\[
		\xi_{\mathrm{univ}} \colon \quad \ses{\pullb{\pr_1}\mc{G}}{\mc{E}}{\pullb{\pr_1}\mc{F}}
	\]
over $X\times V$
such that for all Noetherian affine $k$-schemes $Y$, the map
$\Mor_{k}(Y,V)\to\Ext^1_{X_Y}(\mc{F}_Y,\mc{G}_Y)$ defined by
$\alpha \mapsto \pullb{(\id_X\times \alpha)} \xi_{\mathrm{univ}}$
is a bijection, functorial in $Y$.
In particular, pulling back $\xi_{\text{univ}}$ gives a bijection $\Mor_{k}(\Spec(k),V)\xto{\sim} \Ext^1_{X}(\mc{F},\mc{G})$.
\end{proposition}

\begin{proof}
Write $Y=\Spec(A)$. We aim to construct a functorial isomorphim
\[
\Mor_{k}(Y,V)\simeq \Ext^1_{X_Y}(\mc{F}_Y, \mc{G}_Y).
\]
Given such an isomorphism for all $Y$, the required universal extension is the image of $\id\in\Mor_{k}(V,V)$.

Note that there exist functorial isomorphisms
\begin{align*}
\Mor_{k}(Y,V)
\simeq & \Hom_{\text{k-alg}}(\Sym\Ext^1_X(\mc{F},\mc{G})\dual,A) 
\simeq \Hom_{\text{k-mod}}(\Ext^1_X(\mc{F},\mc{G})\dual,A) \\
\simeq & A \otimes_k \Ext^1_{X}(\mc{F},\mc{G}).
\end{align*}
For the final isomorphism
$A \otimes_k \Ext^1_{X}(\mc{F},\mc{G})\simeq
\Ext^1_{X_Y}(\mc{F}_Y,\mc{G}_Y),$
it suffices to prove that the $\delta$-functors\footnotemark{} $A\otimes_k \Hom_X(\mc{F},-)$ and
$\Hom_{X_Y}(\mc{F}_Y, {-}_Y)$ are canonically isomorphic.

\footnotetext{Recall that $A\otimes_k -$ is exact.}

In fact, there exists a canonical homomorphism $A\otimes_k \Hom_X(\mc{F},\mc{G}) \to\Hom_{X\times Y}(\mc{F}_Y, {\mc{G}}_Y)$, functorial in $\mc{G}$, that sends an elementary tensor $a \otimes u$ to the homomorphism $a\otimes u$. This is an isomorphism on stalks by
\cite[Ch.\ \textsc{I}, \S 2.10]{bourbaki-commutative-algebra}.
There, we need the assumptions that $\mc{F}$ is coherent and $X$ Noetherian. 
\end{proof}

The scheme $V$ of \Cref{cor:universal-extension} is a special case of the solution to the more general moduli problem of classifying relative families of sheaves. The rest of this section sketches the more general situation. The material is taken from the article \cite{lange-universal-extensions}.

\begin{definition}\begin{enumerate}
	\item The \emph{$i$-th relative Ext module} $\EXT^i_f(\mc{F},\mc{G})$ is the image of $\mc{G}$ under the right-derived functor
	$R^i(\pushf{f}\HOM(\mc{F},\mc{G}))
	\from \Mod_{\mc{O}_X} \to \Mod_{\mc{O}_S}$.

	\item For $s\in S$, define the homomorphism
	\[
		\Phi_s = \Phi_{s,\mc{F},\mc{G}}
		\from \Ext^1_X(\mc{F},\mc{G})
		\to \Ext^1_{X_s}(\mc{F}_s, \mc{G}_s)
	\]
	by restricting extensions of $\mc{F}$ by $\mc{G}$ to the fiber $X_s$. This is well-defined, since $\mc{F}$ is flat over $S$.

	\item A \emph{family of extensions} of $\mc{F}$ by $\mc{G}$ over $S$ is a family
	\[
		\xi_s \in \Ext^1_{X_s}(\mc{F}_s,\mc{G}_s),\quad s\in S
	\]
	such that there exists an open covering $\mathfrak{U}$ of $S$ and for all $U\in \mathfrak{U}$ an extension $\xi_U \in \Ext^1_{f^{-1}(U)}(\mc{F}_U,\mc{G}_U)$
	with $\Phi_{s,\mc{F}_U,\mc{G}_U}(\xi_U) = \xi_s$ for all $s\in S$.
	Such a family is \emph{globally defined} if we can take $\mathfrak{U} = \{S\}$.
\end{enumerate}
\end{definition}

\begin{remark}
	If $S$ is affine, then we have $\EXT^i_f(\mc{F},\mc{G})=\Ext^i_X(\mc{F},\mc{G}){\ \widetilde{}}$.
\end{remark}

\begin{proposition}
	Let $g \from Y \to S$ be a morphism of Noetherian schemes.
	There exists a number $N\geq 0$ depending on $\mc{G}$ such that for all quasi-coherent $\mc{O}_Y$-modules $\mc{M}$, all $i\geq 1$ and $n\geq N$ we have
	\[
		\EXT^i_{f_Y}(\mc{O}_{X_Y}(-n),\mc{G} \boxtimes \mc{M}) = 0
	\]
\end{proposition}

\begin{proposition}
	Let $g \from Y \to S$ be a morphism of Noetherian schemes.
	For all $i\geq 0$ there exists a canonical base change homomorphism
	\[
		\tau^i_{g} \from \pullb{g}\EXT^i_{f}
		(\mc{F},\mc{G})
		\to
		\EXT^i_{f_Y}
		(\pullb{g_X}\mc{F}, \pullb{g_X}\mc{G}).
	\]
	Furthermore, if $g$ is flat, then $\tau^i_g$ is an isomorphism for all $i\geq 0$.
\end{proposition}

\begin{definition}
	We say that $\EXT^i_{f}(\mc{F},\mc{G})$ \emph{commutes with base change} if for all morphisms of Noetherian schemes $g \from Y \to S$, the base change homomorphism $\tau^i_g$ is an isomorphism.
\end{definition}

\begin{proposition}
\label{prop:ext-base-change}
	Let $s \in S$ be a point such that $\tau^i_s$ is surjective. Then there exists an open neighborhood $U$of $s$ such that $\tau^i_{s'}$ is an isomorphism for all $s'\in U$.
	Furthermore, the homomorphism $\tau^{i-1}_{s}$ is surjective if and only if $\EXT^i_{f}(\mc{F},\mc{G})$ is locally free on an open neighborhood of $s$.
\end{proposition}

\begin{remark}
\begin{enumerate}
	\item If $\tau^i_{s}$ is an isomorphism for all $s\in S$, then $\EXT_{f}^i(\mc{F},\mc{G})$ commutes with base change.

	\item From \Cref{prop:ext-base-change} we conclude that if $\EXT^i_f(\mc{F},\mc{G})$ commutes with base change for $i=0,1$, then $\EXT^1_f(\mc{F},\mc{G})$ is locally free.

	\item In case $S$ is reduced, if $\EXT^1_f(\mc{F},\mc{G})$ is locally free then $\EXT^i_f(\mc{F},\mc{G})$ commutes with base change for $i=0,1$.
\end{enumerate}
\end{remark}

\begin{definition} 
	Let $u\from Y'\to Y$ be a morphism of Noetherian $S$-schemes.

	\begin{enumerate}\item We define a functoriality map
	$H^0(Y,\EXT^1_{f_Y}(\mc{F}_Y,\mc{G}_Y))
	\to
	H^0(Y',\EXT^1_{f_{Y'}}(\mc{F}_{Y'},\mc{G}_{Y'}))
	$
	as the composition
	\begin{align*}
		H^0(Y,\EXT^1_{f_Y}(\mc{F}_Y,\mc{G}_Y))
		\xto{1\otimes \id} & 
		H^0(Y',\pullb{u}\EXT^1_{f_Y}(\mc{F}_Y,\mc{G}_Y)) \\
		\xto{H^0(\tau^1_u)} &
		H^0(Y',\EXT^1_{f_{Y'}}(\pullb{u_{X_Y}}\mc{F}_{Y'},\pullb{u_{X_Y}}\mc{G}_{Y'})).
	\end{align*}

	\item Given a family of extensions $\xi = (\xi_y)_{y\in Y}$ of $\mc{F}_Y$ by $\mc{G}_Y$ over $Y$, we set $(\pullb{u}\xi)_{y'} \coloneqq \pullb{u}\xi_{u(y')}$ for every $y' \in Y'$. This defines a family $\pullb{u}\xi$ of extensions of $\mc{F}_{Y'}$ by $\mc{G}_{Y'}$ over $Y'$.

	\item We define the functors
	\begin{align*}
		& E,E' \from (\textup{NoethSch}/S) \to (\textup{Sets}); \\
		%E'_{\text{glob}}
		& E(Y) \coloneqq H^0(Y,\EXT^1_{f_Y}(\mc{F}_Y,\mc{G}_Y)), \\
		& E'(Y) \coloneqq \{\text{families of extensions of $\mc{F}_Y$ by $\mc{G}_Y$ over } Y\}. \\
%		& E'_{\glob}(Y) \coloneqq \{\text{globally defined families of extensions of $\mc{F}_Y$ by 
%		$\mc{G}_Y$ over } Y\}.
	\end{align*}
\end{enumerate}

\end{definition}

\begin{remark}
	The spectral sequence $E_2^{p,q}=H^p(S,\EXT^q_f(\mc{F},\mc{G})) \Rightarrow \Ext^{p+q}_X(\mc{F},\mc{G})$ gives an exact sequence
	\begin{align*}
		0
		 \to & H^1(S,\pushf{f}\HOM(\mc{F},\mc{G}))
		 \xto{\varepsilon} \Ext^1_X(\mc{F},\mc{G})
		 \xto{\mu} H^0(S,\EXT^1_f(\mc{F},\mc{G})) \\
		 \xto{d_2} & H^2(S,\pushf{f}\HOM(\mc{F},\mc{G})).
	\end{align*}
\end{remark}

\begin{proposition}
	Suppose that $S$ is reduced and $\EXT^1_f(\mc{F},\mc{G})$ commutes with base change. Restricted to the category of reduced Noetherian $S$-schemes, the functors $E$ and $E'$ are isomorphic.
\end{proposition}

\begin{proposition}
	Suppose that $\EXT^1_f(\mc{F},\mc{G})$ commutes with base change for $i=0,1$. Then the $\mc{O}_S$-module $\EXT^1_f(\mc{F},\mc{G})\dual$ is locally free and the functor $E$ is representable by the $S$-scheme $\VV(\EXT^1_f(\mc{F},\mc{G})\dual)$.
\end{proposition}

\begin{corollary}
	Suppose that $S$ is reduced and $\EXT^1_f(\mc{F},\mc{G})$ commutes with base change for $i=0,1$. Restricted to the category of reduced Noetherian $S$-schemes, the functor $E'$ is representable by the $S$-scheme $\VV(\EXT^1_f(\mc{F},\mc{G})\dual)$.
\end{corollary}

\begin{corollary}
	Suppose that $S$ is affine and $\EXT^1_f(\mc{F},\mc{G})$ commutes with base change for $i=0,1$. The functor
	\[
		(\textup{Aff}/{S}) \to (\textup{Sets})
		\colon
		Y \mapsto \Ext^1_{X_Y}(\mc{F}_Y,\mc{G}_Y)
	\]
	is representable by the $S$-scheme $\VV(\EXT^1_f(\mc{F},\mc{G})\dual)$.
\end{corollary}

\begin{remark}
As a special case of the above, we recover \Cref{cor:universal-extension}.
\end{remark}

\begin{remark}
	The article \cite{lange-universal-extensions} continues on to define a (projectivized) version of the problem, so that over $\Spec(k)$, the scheme $\PP(\Ext^1_X(\mc{F},\mc{G})\dual)$ parametrizes the equivalence classes of nonsplit extensions of $\mc{F}$ by $\mc{G}$, modulo the action of $k^{\times}$. See also \cite[Example 2.1.12]{huybrechts-lehn-sheaves}.
\end{remark}

% \begin{proposition}
% 	 Let $\basescheme$ be reduced and suppose that $\EXT^1_\totalmap(\extendedtotalmodule,\extendingtotalmodule)$ commutes with base change. Then there exists a bijection, functorial in $Y$ between the set of all families of extension of $\extendedtotalmodule$ by $\extendingtotalmodule$over $Y$ and the set
% 	 $H^0(\basescheme, \Ext^1_\totalmap(\extendedtotalmodule, \extendingtotalmodule))$.
% \end{proposition}